---
puppeteer:
    pdf:
        format: A4
        displayHeaderFooter: true
        landscape: false
        scale: 0.8
        margin:
            top: 1.2cm
            right: 1cm
            bottom: 1cm
            left: 1cm
    image:
        quality: 100
        fullPage: false
---

Credential Definition format
==

- 주제
    - ZKP Credentail Definition 구조 정의
- 작성: 박동준
- 일자: 2025-04-02
- 버전: v1.0.0

개정이력
---

| 버전   | 일자       | 변경 내용 |
| ------ | ---------- | --------- |
| v1.0.0 | 2025-04-02 | 초안      |


<div style="page-break-after: always;"></div>

---

<!-- TOC tocDepth:2..4 chapterDepth:2..6 -->

- [Credential Definition format](#credential-definition-format)
  - [개정이력](#개정이력)
  - [1. 개요](#1-개요)
    - [1.1. 참조문서](#11-참조문서)
  - [2. Credential Definition 구조](#2-credential-definition-구조)
    - [2.1. `CredentialDefinition` object](#21-credentialdefinition-object)
  - [3. 예시](#3-예시)
    - [3.2. `운전면허증 Credential Definition`](#32-운전면허증-credential-definition)

<!-- /TOC -->


<div style="page-break-after: always;"></div>

## 1. 개요

본 문서는 OpenDID ZKP에서 사용하는 Credential Definition의 구조와 관련 정보를 정의한다.

Credential Definition (CredDef)을 정의하는 정보입니다.
Credential Definition은 특정 Credential Schema에 따라 Credential을 발급하는 방식과 서명 방식을 정의합니다.
발급자(Issuer)가 Credential을 발급하려면 반드시 Credential Definition을 생성해야 합니다.


본 문서는 Credential Definition을 정의하기 위한 문서 형식인 Credential Definition format을 정의하는 것을 목적으로 한다.
format은 모두 OSD (OpenDID Schema Definition Language)로 정의한다.

### 1.1. 참조문서

| 참조명              | 문서명                                              | 위치 |
| ------------------- | ----------------------------------------------- | ---- |
| [OSD]               | OpenDID Schema Definition Language              |      |
| [ZKP-DATA-SPEC]     | (OpenDID) 데이터 명세서(ZKP Data Specification)     |      |
| [CREDENTIAL-FORMAT] | (OpenDID) Credential format                     |      |


<div style="page-break-after: always;"></div>

## 2. Credential Definition 구조
여기에 정의되지 않은 항목은 `[ZKP-DATA-SPEC]`을 참조한다.


### 2.1. `CredentialDefinition` object
Credential Definition (CredDef)**을 정의하는 정보입니다.
특정 Credential Schema에 따라 Credential을 발급하는 방식과 서명 방식을 정의합니다.
발급자(Issuer)가 Credential을 발급하려면 반드시 Credential Definition을 생성해야 합니다.
```c#
def object CredentialDefinition : "Credential 정의"
{
    + definition-identifier "id"          : "Credential Definition 식별자"
    + schema-identifier     "schemaId"    : "Credential Schema 식별자"
    + string                "ver"         : "Version"
    + CREDENTIAL_TYPE       "type"        : "Credential 서명 타입"
    + object                "value"       : "value"
    {
        + object "primary" : "기본증명
        {
            + string "n" :  "n"
            + string "z" :  "z"
            + string "s" :  "s"
            + object "r" :  "r", min_extend(2)
            {
                /* 
                ... 예시 (순서 보장 필요)
                - string "zkpsex" : "성별"
                - string "zkpasort" : "면허번호"
                - string "zkpaddr" : "주소"
                - string "zkpbirth" : "생년월일"
                */
                - string $attribute : "zkpsex" : "예시) 성별"
                + string "masterSecret" : "마스터 시크릿"
            }
            + string "rctxt" : "rctxt"
        }
    }
    + string "tag" : "태그"
}
```
- `~/id`: Credential Schema의 고유 식별자(ID). 특정 스키마를 참조하기 위해 사용됨.
- `~/schemaId` : Credential이 따르는 Schema(스키마) ID. 어떤 데이터 구조를 따르는지 정의한 Schema를 참조.
- `~/ver`: Credential Definition의 버전(Version).
- `~/type`: Credential의 서명 방식(Type). CL은 CL 서명(Clairaut-Lippold) 방식을 의미하며, 영지식 증명(ZKP) 기반 Credential 발급에 사용되는 기본 서명 방식.
- `~/value/primary`: 발급자 서명 키 및 암호학적 파라메터
- `~/value/primary/n`: 공개 키의 일부로 사용되는 큰 소수
- `~/value/primary/z`: 공개 키의 또 다른 구성 요소.
- `~/value/primary/s`: 발급자의 서명 키와 관련된 암호학적 요소.
- `~/value/primary/r`: Credential에 포함되는 속성(Attribute)별 암호학적 커밋(Commitment) 값.
- `~/value/primary/r/zkpsex`: 성별(sex) 속성에 대한 암호학적 커밋 값
- `~/value/primary/r/zkpsort`: 개인 식별 번호(passport 또는 주민등록번호 일부) 속성에 대한 커밋 값
- `~/value/primary/r/zkpaddr`: 주소(address) 속성에 대한 커밋 값
- `~/value/primary/r/zkpbirth`: 생년월일(birth) 속성에 대한 커밋 값
- `~/value/primary/r/masterSecret`: 피증명인의 Master Secret에 대한 암호학적 커밋 값. Credential을 연결하여 신원을 증명하는 데 사용됨.
- `~/value/primary/rctxt`: 발급자가 서명할 때 사용하는 블라인드 값. Credential Request에서 blindedMs를 받을 때 사용됨.
- `~/tag`: Credential Definition을 식별하는 태그(Tag). 동일한 스키마(Schema)라도 여러 Credential Definition이 존재할 수 있으며, 이를 구분하는 역할.
  
<div style="page-break-after: always;"></div>

## 3. 예시
본 장에서는 Credential Definition의 이해를 돕기 위해 구체적인 예를 들어 추가로 설명한다.

### 3.2. `운전면허증 Credential Definition`

```json
{
    "id": "did:omn:NcYxiDXkpYi6ov5FcYDi1e:3:CL:did:omn:NcYxiDXkpYi6ov5FcYDi1e:2:mdl:1.0:Tag1",
    "schemaId": "did:omn:NcYxiDXkpYi6ov5FcYDi1e:2:mdl:1.0",
    "ver": "1.0",
    "type": "CL",
    "value": {
      "primary": {
        "n": "125559773035285539946308580674909849538727175560473791776455666848612349178831339131138347554200440450043660143408875072844477928321064308025077811357235355663510162649466695527282413015653533276205518906780572754625599502611081611014778334692952200515238223320152113096017899139393843957971507398146365378044609579246148134571625821372833940811885460989739217825724761144118887993962399373161449856791840242002404417904165391179650441846164823871558319998964865818916827210714141959293226846093667775717073126112986998574200101523245732192732680632649674656114851119185251812326417908839166684950606392898534333598577",
        "z": "56380277913896568199272055101153067978733711820403575496415934262513275549195334021408249244315547339134240340318691549070387792321829958897740297061502110103142106325871855873008786783428091408659817373310888174135042562330063303691817835328430489492840196052928767647371619165494899953248628043690409954745647227667836298644435182456847712503838809341077552738101429025643926364191359200302385671111465287071369103318475447041663884824069372337623176305574445132825641059044211453031157872940997871491322968530745888668884589391235969834765047695568050965892557330619329382233544462108603803674449571369507923180302",
        "s": "109658388152835170949057518341513932558868046512299628945126685146653862258555781979927733976479994971503491461452784143175436274515215715386426411232864765525943184766596308504383997581491056808751254553235253783000638890192319061831608436689760083727908007430694878829625560045015246562933601988536686188278449191748218979547288809875047101084040853225566486752066653914193112218771041488685684968164656439703217569336762936288835592869575148456714176416400508038302481560959620079549428969308822321187828682344676384138439717747507217911338094504424553026231128625866329041718315511230159574692423365498677415220666",
        "r": {
          "zkpsex": "47431877646592920331441139135245495199885359562956164953144774804635823840966059618566695413029238400588719016715051337825465457775156853589046692488323855643004398260331666668697792324924316600380471328490328736880025449283336679053290488992209022627187204009114458066992688247963046559992747908779466084096625242329656999835380119210400312501908950623863176322239631754136568215070622523994360109962831698843427935887441370894445416017669611790095662138304426698787425616743060866496017461026720834465709464446593887241417462411897800635454548514583346287244961163115276635944586682488113702496248501560666933485174",
          "zkpasort": "89711143437963011861681076888775696269969288956086991493397186239861523334033902978093630890845396500872708785020381151896942872190788735799331327289746758445532933483302225311271521934488196795635006912718138747993288165166034706214637494702168578864226423779166502686065673584335496036568590643224291192944678834898467401424987759408365609929656702767410279846359720890537317953695427644986785752578152069385082002058989188587713494681552911207181151484040444525322587464224448809652682261256942582062141984030551086325944229461624010829577410271108817276052306575612651808959343814340879725286531603159914996942868",
          "zkpaddr": "66529326344824051332906998045411147768456533734770290376854352422879021647836366875163747500569682624477095789699709716091336117860792384888165764241078349345493840215271110641045892041452110879909407137837779300424074476139714114957146638618460060876127392229603799271090307110248439852284651072111289239364272515824602961026034834967710412326066384159451813011349613860638834762013779514162135162055229855435268167981823221348901549829204582622877546448208993620314537531920547842701886888426245227461006967436836597604737720082162097821464633437318794810777370902023945081261017026078165091388642012840816168270272",
          "zkpbirth": "21849410504153856950279145583790808625135531745638437068139908456259056941865555471608385327544739078589000555395375917355871800768422514547392092141214471538547035260549811564391016213062956190788132770815229529968385780639151936986239589362726567466741791150426081888516045605969799145523172137851780920002844086395931628846050012892253489669349593981086737018629075357461240236231503462822821696149248699435546326034744769848969248417906693644253497493375066636769186856283666385328131125398656261727570171295950026330843685867080486036388663799804655026747304829687412411558291203028155435888263683949632825453451",
          "masterSecret": "86665316944736799202556726655937824773163055459634377932622148491407580710743283891428533056691546568134018685512299923682840025353133307447097497009745819248996333767227790279543530488991587832966234511310002828269868709003011725968598452376248664177479600145969453776353588655171309948718474531063416237660635566195579975499101671827637499619462970030871198985605811240678291742457123592400370309624576262517783583838233436226170202346445185187840653559890572280987641283209421917345050852553123219869704846153186105185557137863816899536946870688122849086045201922202965745611269331046856175316422510577406408267524"
        },
        "rctxt": "55015475910707899851497053744250749325944332698951216400915118387158443076279741690626748500137191324382595657004763295675733760474269920790132388180951530446437819330566869562378875688028567850054431454927191249820041984535772567641589712148784124021250128773808862234259461954423468214352488731055440992669481868299786434763319321706093593151416313075353371144189756987784300786802166059252810307023155157867221091776002220169414637270558150787890191002059220703456323306195255041980369518476166509701885132459798505250184014241175890813116539245301891391148949369262263790505050413842890576768195129570770338587626"
      }
    },
    "tag": "Tag1"
  }
}
```


