<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1839px" preserveAspectRatio="none" style="width:1706px;height:1839px;background:#FFFFFF;" version="1.1" viewBox="0 0 1706 1839" width="1706px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="25" font-weight="bold" lengthAdjust="spacing" textLength="468" x="615" y="39.1699">ZKP Proof Submission - Direct Mode</text><rect fill="#FDF5E6" height="1776.9883" style="stroke:#181818;stroke-width:0.5;" width="533.5" x="301" y="56.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45" x="543.25" y="69.0117">Mobile</text><rect fill="#FFFFFF" height="1603.0117" style="stroke:#181818;stroke-width:1.0;" width="10" x="373" y="141.9316"/><rect fill="#FFFFFF" height="186.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="791" y="565.9004"/><rect fill="#FFFFFF" height="305.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="791" y="1061.8691"/><rect fill="#FFFFFF" height="202.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1199" y="270.4844"/><rect fill="#FFFFFF" height="323.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1199" y="1412.2168"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="131.9316" y2="1753.9434"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="378" x2="378" y1="131.9316" y2="1753.9434"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="795.5" x2="795.5" y1="131.9316" y2="1753.9434"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1203.5" x2="1203.5" y1="131.9316" y2="1753.9434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32" x="5" y="128.9785">User</text><ellipse cx="24" cy="63.9434" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24,71.9434 L24,98.9434 M11,79.9434 L37,79.9434 M24,98.9434 L11,113.9434 M24,98.9434 L37,113.9434 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32" x="5" y="1766.4785">User</text><ellipse cx="24" cy="1777.9316" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24,1785.9316 L24,1812.9316 M11,1793.9316 L37,1793.9316 M24,1812.9316 L11,1827.9316 M24,1812.9316 L37,1827.9316 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146" x="305" y="83.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="357" y="104.4902">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="132" x="312" y="120.9785">Authorization App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146" x="305" y="1752.9434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="357" y="1773.4785">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="132" x="312" y="1789.9668">Authorization App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="761.5" y="83.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="768.5" y="104.4902">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="773.5" y="120.9785">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="761.5" y="1752.9434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="768.5" y="1773.4785">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="773.5" y="1789.9668">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1168.5" y="83.9551"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="1175.5" y="104.4902">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="54" x="1177" y="120.9785">Verifier</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1168.5" y="1752.9434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="1175.5" y="1773.4785">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="54" x="1177" y="1789.9668">Verifier</text><rect fill="#FFFFFF" height="1603.0117" style="stroke:#181818;stroke-width:1.0;" width="10" x="373" y="141.9316"/><rect fill="#FFFFFF" height="186.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="791" y="565.9004"/><rect fill="#FFFFFF" height="305.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="791" y="1061.8691"/><rect fill="#FFFFFF" height="202.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1199" y="270.4844"/><rect fill="#FFFFFF" height="323.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1199" y="1412.2168"/><polygon fill="#32CD32" points="336,146.9316,1245,146.9316,1255,165.9316,1245,184.9316,336,184.9316,326,165.9316,336,146.9316" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="620.25" y="163.5">Information obtained through Offer phase:</text><ellipse cx="625.75" cy="174.0527" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329" x="632.25" y="178.8105">device, service, (optional)offerId, (optional)passcode</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1699" x="0" y="211.208"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1699" y1="211.208" y2="211.208"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1699" y1="214.208" y2="214.208"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="234" x="732.5" y="200.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="738.5" y="217.1211">1. Request Proof Request Profile</text><polygon fill="#181818" points="1187,266.4844,1197,270.4844,1187,274.4844,1191,270.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="1193" y1="270.4844" y2="270.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="390" y="258.0869">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="413" y="250.4316">Request Proof Request Profile</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="413" y="265.7422">{offerId}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="299.7949" y2="299.7949"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="299.7949" y2="312.7949"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="312.7949" y2="312.7949"/><polygon fill="#181818" points="1220,308.7949,1210,312.7949,1220,316.7949,1216,312.7949" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1216" y="295.0527">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1239" y="295.0527">Validate offerId</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="388.0371" y2="388.0371"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="388.0371" y2="401.0371"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="401.0371" y2="401.0371"/><polygon fill="#181818" points="1220,397.0371,1210,401.0371,1220,405.0371,1216,401.0371" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1216" y="360.3291">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="1239" y="337.3633">Prepare Proof Request Profile data</text><ellipse cx="1244.5" cy="347.916" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="1251" y="352.6738">proofRequest = Generate ZKP proofRequest</text><ellipse cx="1244.5" cy="363.2266" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="1251" y="367.9844">reqE2e = Generate E2E request info</text><ellipse cx="1244.5" cy="378.5371" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="1251" y="383.2949">Other data omitted</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="430.3477" y2="430.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="430.3477" y2="443.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="443.3477" y2="443.3477"/><polygon fill="#181818" points="1220,439.3477,1210,443.3477,1220,447.3477,1216,443.3477" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="1216" y="425.6055">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448" x="1239" y="425.6055">(ProofRequestProfile)proofRequestProfile = Create Proof Request Profile</text><polygon fill="#181818" points="394,468.6582,384,472.6582,394,476.6582,390,472.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388" x2="1203" y1="472.6582" y2="472.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="400" y="467.916">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="423" y="467.916">{proofRequestProfile}</text><polygon fill="#32CD32" points="336,485.6582,836,485.6582,846,504.6582,836,523.6582,336,523.6582,326,504.6582,336,485.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="441.75" y="502.2266">Generate wallet token {purpose = "PresentVp"}</text><ellipse cx="447.25" cy="512.7793" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="453.75" y="517.5371">walletToken = wallet token</text><polygon fill="#181818" points="779,561.9004,789,565.9004,779,569.9004,783,565.9004" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="785" y1="565.9004" y2="565.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="390" y="553.5029">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="413" y="545.8477">Query available credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="413" y="561.1582">{walletToken, proofRequestProfile}</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="595.2109" y2="595.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="595.2109" y2="608.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="608.2109" y2="608.2109"/><polygon fill="#181818" points="812,604.2109,802,608.2109,812,612.2109,808,608.2109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="808" y="590.4688">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="831" y="590.4688">Validate walletToken</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="637.5215" y2="637.5215"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="637.5215" y2="650.5215"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="650.5215" y2="650.5215"/><polygon fill="#181818" points="812,646.5215,802,650.5215,812,654.5215,808,650.5215" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="808" y="632.7793">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="831" y="632.7793">Validate proofRequestProfile.proof</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="710.4531" y2="710.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="710.4531" y2="723.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="723.4531" y2="723.4531"/><polygon fill="#181818" points="812,719.4531,802,723.4531,812,727.4531,808,723.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="808" y="690.4004">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="831" y="675.0898">Search for credentials</text><ellipse cx="836.5" cy="685.6426" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="843" y="690.4004">Match attributes</text><ellipse cx="836.5" cy="700.9531" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="843" y="705.7109">Generate usable referent list</text><polygon fill="#181818" points="394,748.7637,384,752.7637,394,756.7637,390,752.7637" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388" x2="795" y1="752.7637" y2="752.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="400" y="748.0215">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="432" y="748.0215">{referent}</text><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="425" y1="782.0742" y2="782.0742"/><line style="stroke:#181818;stroke-width:1.0;" x1="425" x2="425" y1="782.0742" y2="795.0742"/><line style="stroke:#181818;stroke-width:1.0;" x1="384" x2="425" y1="795.0742" y2="795.0742"/><polygon fill="#181818" points="394,791.0742,384,795.0742,394,799.0742,390,795.0742" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="390" y="777.332">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="422" y="777.332">Display list of available credentials</text><polygon fill="#0000FF" points="361,820.3848,371,824.3848,361,824.3848" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="24" x2="372" y1="824.3848" y2="824.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="31" y="819.6426">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="63" y="819.6426">Select a credential</text><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="425" y1="853.6953" y2="853.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="425" x2="425" y1="853.6953" y2="866.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="384" x2="425" y1="866.6953" y2="866.6953"/><polygon fill="#181818" points="394,862.6953,384,866.6953,394,870.6953,390,866.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="390" y="848.9531">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="422" y="848.9531">credentialId = Selected credential ID</text><polygon fill="#0000FF" points="361,892.0059,371,896.0059,361,896.0059" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="24" x2="372" y1="896.0059" y2="896.0059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="31" y="891.2637">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="63" y="891.2637">Select claims to submit (attributes, predicates)</text><rect fill="#FEFFDD" height="38" style="stroke:#181818;stroke-width:0.5;" width="225" x="265" y="909.0059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="269" y="925.5742">Query credSchema on blockchain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="269" y="940.8848">Query credDef on blockchain</text><polygon fill="#0000FF" points="361,969.9375,371,973.9375,361,973.9375" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="24" x2="372" y1="973.9375" y2="973.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="31" y="969.1953">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="63" y="969.1953">Consent to submission</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1699" x="0" y="1002.5928"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1699" y1="1002.5928" y2="1002.5928"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1699" y1="1005.5928" y2="1005.5928"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="172" x="763.5" y="991.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="769.5" y="1008.5059">2. Request Verify Proof</text><polygon fill="#181818" points="779,1057.8691,789,1061.8691,779,1065.8691,783,1061.8691" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="785" y1="1061.8691" y2="1061.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="390" y="1049.4717">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="422" y="1041.8164">Request Proof Submission</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="422" y="1057.127">{walletToken, proofRequest, proofParams, selfAttributes}</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="1091.1797" y2="1091.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="1091.1797" y2="1104.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="1104.1797" y2="1104.1797"/><polygon fill="#181818" points="812,1100.1797,802,1104.1797,812,1108.1797,808,1104.1797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="808" y="1086.4375">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="840" y="1086.4375">Validate walletToken</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="1210.043" y2="1210.043"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="1210.043" y2="1223.043"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="1223.043" y2="1223.043"/><polygon fill="#181818" points="812,1219.043,802,1223.043,812,1227.043,808,1223.043" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="808" y="1167.0244">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="840" y="1128.748">Perform E2E ECDH</text><ellipse cx="845.5" cy="1139.3008" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="852" y="1144.0586">_, pubKeyE2E = Generate ECC key pair</text><ellipse cx="845.5" cy="1154.6113" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="852" y="1159.3691">e2eKey = Create encryption key using profile E2E data</text><ellipse cx="845.5" cy="1169.9219" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="852" y="1174.6797">iv = Generate IV</text><ellipse cx="845.5" cy="1185.2324" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="852" y="1189.9902">(AccE2e)accE2e = {pubKeyE2E, iv}</text><ellipse cx="845.5" cy="1200.543" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="852" y="1205.3008">signKeyAgree(accE2e)</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="1267.6641" y2="1267.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="1267.6641" y2="1280.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="1280.6641" y2="1280.6641"/><polygon fill="#181818" points="812,1276.6641,802,1280.6641,812,1284.6641,808,1280.6641" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="808" y="1255.2666">(19)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="840" y="1247.6113">Generate proof</text><ellipse cx="845.5" cy="1258.1641" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332" x="852" y="1262.9219">proof = CreateProof(proofReq, proofParam, selfAttrs)</text><line style="stroke:#181818;stroke-width:1.0;" x1="801" x2="843" y1="1325.2852" y2="1325.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="843" x2="843" y1="1325.2852" y2="1338.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="843" y1="1338.2852" y2="1338.2852"/><polygon fill="#181818" points="812,1334.2852,802,1338.2852,812,1342.2852,808,1338.2852" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="808" y="1312.8877">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="840" y="1305.2324">Encrypt proof</text><ellipse cx="845.5" cy="1315.7852" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="852" y="1320.543">encProof = enc(proof, e2eKey, iv)</text><polygon fill="#181818" points="394,1363.5957,384,1367.5957,394,1371.5957,390,1367.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388" x2="795" y1="1367.5957" y2="1367.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="400" y="1362.8535">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="432" y="1362.8535">{accE2e, encProof}</text><polygon fill="#181818" points="1187,1408.2168,1197,1412.2168,1187,1416.2168,1191,1412.2168" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="383" x2="1193" y1="1412.2168" y2="1412.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="390" y="1399.8193">(22)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="422" y="1392.1641">Request Verify Proof</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="422" y="1407.4746">{accE2e, encProof}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="1487.459" y2="1487.459"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="1487.459" y2="1500.459"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="1500.459" y2="1500.459"/><polygon fill="#181818" points="1220,1496.459,1210,1500.459,1220,1504.459,1216,1500.459" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1216" y="1459.751">(23)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="1248" y="1436.7852">Perform E2E ECDH</text><ellipse cx="1253.5" cy="1447.3379" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="1260" y="1452.0957">If accE2e.proof exists, verify</text><ellipse cx="1253.5" cy="1462.6484" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="1260" y="1467.4063">e2eKey = Generate encryption key</text><ellipse cx="1253.5" cy="1477.959" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="1260" y="1482.7168">iv = accE2e.iv</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="1545.0801" y2="1545.0801"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="1545.0801" y2="1558.0801"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="1558.0801" y2="1558.0801"/><polygon fill="#181818" points="1220,1554.0801,1210,1558.0801,1220,1562.0801,1216,1558.0801" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1216" y="1532.6826">(24)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="1248" y="1525.0273">Decrypt encProof</text><ellipse cx="1253.5" cy="1535.5801" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="1260" y="1540.3379">proof = dec(debase(encProof), e2eKey, iv)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="1587.3906" y2="1587.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="1587.3906" y2="1600.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="1600.3906" y2="1600.3906"/><polygon fill="#181818" points="1220,1596.3906,1210,1600.3906,1220,1604.3906,1216,1600.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1216" y="1582.6484">(25)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1248" y="1582.6484">Verify Proof</text><rect fill="#FEFFDD" height="53" style="stroke:#181818;stroke-width:0.5;" width="429" x="989" y="1613.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="993" y="1629.959">Query credSchema on blockchain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="993" y="1645.2695">Query credDef on blockchain</text><ellipse cx="998.5" cy="1655.8223" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409" x="1005" y="1660.5801">Verify based on proofs, aggregatedProof, requestedProof in Proof</text><line style="stroke:#181818;stroke-width:1.0;" x1="1209" x2="1251" y1="1693.6328" y2="1693.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1251" x2="1251" y1="1693.6328" y2="1706.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1210" x2="1251" y1="1706.6328" y2="1706.6328"/><polygon fill="#181818" points="1220,1702.6328,1210,1706.6328,1220,1710.6328,1216,1706.6328" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="1216" y="1688.8906">(26)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="1248" y="1688.8906">Save proof and provide service</text><polygon fill="#181818" points="394,1731.9434,384,1735.9434,394,1739.9434,390,1735.9434" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388" x2="1203" y1="1735.9434" y2="1735.9434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="400" y="1731.2012">(27)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="432" y="1731.2012">OK</text><!--SRC=[dLRVZzeu47xFNs6nBq3PLeTqBmYGAA0MRQlbZhizwMwhod46i3R4gUsafIl-zvjnVc12Ta-wVTd4_hwPySoNprXfOmWO_esD_0cZuQ_Jl-_MRAsLsh9D5XwaCL8bx9Ojf0PXsMSLmVWTOQS1916pBa30CwkIx122PfrnEEtUzCRlmca7DuHLkDRl_sb0z_iTnWtBy348rGyC5ieOsCrz77tYegWZvTfA8LEUMABDChjNMlxabigOfMaPGt0s7kFhTDh6-el7CTWI-ft7Y2sMfaNLc3neK1v0owsiQyotoDc0pa4Z9zWdoW9J-8QP1xHxyqaUu8C6I5m1gsIhzA6eKeMMomImENkjijsUtM-tI4pttC38eViiWbmA631iHV7GLIcHUTnJX5v5_bBAZH7OULUygoK89XFsorlsEtpBmDXoOjxRbZexcRW9o9nZzO870RRjTahbltapUftxc3oNXPnSoSXnp15xuB6CA62vtzXUQy3MmWiL8P4px-ynwREKa1LmmZv00fhYan8lzXey3T-MG_0Po-6ILXrOuaIQZ7kxnq6u6jH1MWlDuhjhBrzPSo-zNiEaSmsKilMOWGQRwOGzjr1FLseYWJRaL9_ekvCji-e9A5ocKsKeUmVRR22n3sddL4ggWFxXa9CBeY-RGW6KaYJmMmRwo7ZEPSn3F9RG465KoME30l0Y3bZhKIWpnIf2Ujhmg2-3MaA-TMl15MS3N8izmu_Chx4vty_S8eXRgsMOMRZQhzkQ6NTS3QXWZCLYQMnGJwrQFbNj4do41cZIc1yT5ANVthGW87DZj__Sl8yp-FBec1k8oJgv1_JYdXTN4Swj0ADvdDVPQl5QN15pUJ0uQMR8i2thdXj0OuD82ZopwGNQrrrGp9xIRCGU3lX992oCbNWIUxGlnZp00hQNkqvHkb1KIsLpbP0uwvhS9U8iQtYsBEUun_838gUwbEQbEvtlejTqMRwjkUO7G-OQRsTrB_wdMjUWoTgTjopdYuzDJNt5f5bu1qS2-5uqdxCdEEBL97MJ0qD0mjb4817wwCpUKJ8ZanqTnLaDnMspJPdxwLOFpVtkJ0Zqnnvt_n3xNDSvGFAfYJTob-3sR8Skr2r8lQjkrFbSerkTl3wMcrotcey_c_Dep7MAPT6CzWpOgL8mz5W47vJzf5Frwe-uEC6WPfnUkFry6QAshccDw-q5EL1nAtG5HozSZC4Fz0hKOLwaQ1D0tS-619fpBkFAl57E0efcrNrfcKO4eXj1YBy-kXMiTzcpnWNlTIIe0dhUaPzN_zD3he5NNkAX-bLkAZOYc3i3jf3lK9OxR5IqBaPUNlFbEzxsZNhF1dLvk0tFA_5oXE1JBYEeVeTLwhc_-nS0]--></g></svg>